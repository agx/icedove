From: Mike Hommey <glandium@debian.org>
Date: Fri, 24 Jul 2009 13:14:04 +0200
Subject: Avoid writing out locked prefs default value in user preferences

https://bugzilla.mozilla.org/show_bug.cgi?id=506224
Closes: #512111
---
 mozilla/modules/libpref/src/prefapi.cpp |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/mozilla/modules/libpref/src/prefapi.cpp b/mozilla/modules/libpref/src/prefapi.cpp
index 4668d95..7e098c1 100644
--- a/mozilla/modules/libpref/src/prefapi.cpp
+++ b/mozilla/modules/libpref/src/prefapi.cpp
@@ -334,8 +334,6 @@ pref_savePref(PLDHashTable *table, PLDHashEntryHdr *heh, PRUint32 i, void *arg)
                           pref->userPref,
                           (PrefType) PREF_TYPE(pref)))
         sourcePref = &pref->userPref;
-    else if (PREF_IS_LOCKED(pref))
-        sourcePref = &pref->defaultPref;
     else
         // do not save default prefs that haven't changed
         return PL_DHASH_NEXT;
-- 
