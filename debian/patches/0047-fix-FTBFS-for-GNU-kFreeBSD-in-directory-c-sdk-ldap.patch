From: Christoph Goehre <chris@sigxcpu.org>
Date: Wed, 3 Mar 2010 18:19:17 +0100
Subject: [PATCH] fix FTBFS for GNU/kFreeBSD in directory/c-sdk/ldap

https://bugzilla.mozilla.org/show_bug.cgi?id=356011
---
 directory/c-sdk/ldap/include/portable.h         |    2 +-
 directory/c-sdk/ldap/libraries/libldap/compat.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/directory/c-sdk/ldap/include/portable.h b/directory/c-sdk/ldap/include/portable.h
index db7a166..e4dc1c6 100644
--- a/directory/c-sdk/ldap/include/portable.h
+++ b/directory/c-sdk/ldap/include/portable.h
@@ -457,7 +457,7 @@ int select(int, fd_set *, fd_set *, fd_set *, struct timeval *);
 #define NSLDAPI_FOPEN( filename, mode )	fopen( filename, mode )
 #endif
 
-#if defined(LINUX) || defined(AIX) || defined(HPUX) || defined(_WINDOWS)
+#if defined(LINUX) || defined(__GNU__) || defined(__GLIBC__) || defined(AIX) || defined(HPUX) || defined(_WINDOWS)
 size_t nsldapi_compat_strlcpy(char *dst, const char *src, size_t len);
 #define STRLCPY nsldapi_compat_strlcpy
 #else
diff --git a/directory/c-sdk/ldap/libraries/libldap/compat.c b/directory/c-sdk/ldap/libraries/libldap/compat.c
index 94e58ca..8cc1a71 100644
--- a/directory/c-sdk/ldap/libraries/libldap/compat.c
+++ b/directory/c-sdk/ldap/libraries/libldap/compat.c
@@ -83,7 +83,7 @@ nsldapi_compat_ctime_r( const time_t *clock, char *buf, int buflen )
 }
 #endif /* HPUX10 && _REENTRANT && !HPUX11 */
 
-#if defined(LINUX) || defined(AIX) || defined(HPUX) || defined(_WINDOWS)
+#if defined(LINUX) || defined(__GNU__) || defined(__GLIBC__) || defined(AIX) || defined(HPUX) || defined(_WINDOWS)
 /* 
  * Copies src to the dstsize buffer at dst. The copy will never 
  * overflow the destination buffer and the buffer will always be null 
-- 
