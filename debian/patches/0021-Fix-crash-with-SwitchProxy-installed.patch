From: Mike Hommey <mh@glandium.org>
Date: Sat, 19 Dec 2009 21:55:53 +0100
Subject: [PATCH] Fix crash with SwitchProxy installed

https://bugzilla.mozilla.org/show_bug.cgi?id=535990
---
 mozilla/modules/libpref/src/prefapi.cpp |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/mozilla/modules/libpref/src/prefapi.cpp b/mozilla/modules/libpref/src/prefapi.cpp
index 652d940..7e098c1 100644
--- a/mozilla/modules/libpref/src/prefapi.cpp
+++ b/mozilla/modules/libpref/src/prefapi.cpp
@@ -795,7 +795,7 @@ PRBool
 PREF_PrefIsLocked(const char *pref_name)
 {
     PRBool result = PR_FALSE;
-    if (gIsAnyPrefLocked) {
+    if (gIsAnyPrefLocked && gHashTable.ops) {
         PrefHashEntry* pref = pref_HashTableLookup(pref_name);
         if (pref && PREF_IS_LOCKED(pref))
             result = PR_TRUE;
-- 
