From: Mike Hommey <mh@glandium.org>
Date: Tue, 9 Mar 2010 09:44:37 +0100
Subject: Allow to build against system libffi

https://bugzilla.mozilla.org/show_bug.cgi?id=551138

---
 mozilla/js/src/configure.in |   12 ++++++++++++
 1 file changed, 12 insertions(+)

Index: icedove/mozilla/js/src/configure.in
===================================================================
--- icedove.orig/mozilla/js/src/configure.in	2012-10-15 20:21:45.483202223 +0530
+++ icedove/mozilla/js/src/configure.in	2012-10-15 20:29:14.607223082 +0530
@@ -3718,6 +3718,18 @@
     AC_DEFINE(JSGC_GENERATIONAL)
 fi
 
+dnl system libffi Support
+dnl ========================================================
+MOZ_ARG_ENABLE_BOOL(system-ffi,
+[  --enable-system-ffi       Use system libffi (located with pkgconfig)],
+    MOZ_NATIVE_FFI=1 )
+
+if test -n "$MOZ_NATIVE_FFI"; then
+    PKG_CHECK_MODULES(MOZ_FFI, libffi)
+fi
+
+AC_SUBST(MOZ_NATIVE_FFI)
+
 dnl ========================================================
 dnl = Perform moving GC stack rooting analysis
 dnl ========================================================
