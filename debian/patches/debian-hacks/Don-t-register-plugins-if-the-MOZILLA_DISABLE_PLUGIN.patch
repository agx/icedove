From: Mike Hommey <glandium@debian.org>
Date: Sat, 27 Sep 2008 17:17:39 +0200
Subject: Don't register plugins if the MOZILLA_DISABLE_PLUGINS environment
 variable is set

---
 mozilla/dom/plugins/base/nsPluginHost.cpp |    4 ++++
 1 file changed, 4 insertions(+)

Index: icedove/mozilla/dom/plugins/base/nsPluginHost.cpp
===================================================================
--- icedove.orig/mozilla/dom/plugins/base/nsPluginHost.cpp	2012-10-13 14:27:17.898188741 +0530
+++ icedove/mozilla/dom/plugins/base/nsPluginHost.cpp	2012-10-13 15:57:15.930439453 +0530
@@ -318,6 +318,10 @@
 
   Preferences::AddStrongObserver(this, "plugin.disable");
 
+  const char *env = PR_GetEnv("MOZILLA_DISABLE_PLUGINS");
+  if (env && env[0])
+    mPluginsDisabled = PR_TRUE;
+
   nsCOMPtr<nsIObserverService> obsService =
     mozilla::services::GetObserverService();
   if (obsService) {
