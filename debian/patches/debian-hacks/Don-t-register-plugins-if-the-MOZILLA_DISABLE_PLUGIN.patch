From: Mike Hommey <glandium@debian.org>
Date: Sat, 27 Sep 2008 17:17:39 +0200
Subject: Don't register plugins if the MOZILLA_DISABLE_PLUGINS environment
 variable is set

---
 mozilla/modules/plugin/base/src/nsPluginHost.cpp |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/mozilla/modules/plugin/base/src/nsPluginHost.cpp b/mozilla/modules/plugin/base/src/nsPluginHost.cpp
index 80987c4..ed7f0c3 100644
--- a/mozilla/modules/plugin/base/src/nsPluginHost.cpp
+++ b/mozilla/modules/plugin/base/src/nsPluginHost.cpp
@@ -397,6 +397,10 @@ nsPluginHost::nsPluginHost()
     }
   }
 
+  const char *env = PR_GetEnv("MOZILLA_DISABLE_PLUGINS");
+  if (env && env[0])
+    mPluginsDisabled = PR_TRUE;
+
   nsCOMPtr<nsIObserverService> obsService =
     mozilla::services::GetObserverService();
   if (obsService) {
-- 
